!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");r(1),AFRAME.registerSystem("stl-exporter",{schema:{verbose:{default:!1}},multiple:!1,init:function(){this.exporter=new THREE.STLExporter},export:function(e,t){var r;console.log("export");var o,n,a=document.createElement("a");function i(e,t){a.href=URL.createObjectURL(e),a.download=t||"data.json",a.dispatchEvent(new MouseEvent("click"))}r=void 0===e?this.sceneEl.object3D:e.object3D,t&&!0===t.binary?(n=this.exporter.parse(r,{binary:!0}),"model-binary.stl",i(new Blob([n],{type:"application/octet-stream"}),"model-binary.stl")):(o=this.exporter.parse(r),"model-ascii.stl",i(new Blob([o],{type:"text/plain"}),"model-ascii.stl"))}})},function(e,t){var r,o;THREE.STLExporter=function(){},THREE.STLExporter.prototype={constructor:THREE.STLExporter,parse:(r=new THREE.Vector3,o=new THREE.Matrix3,function(e,t){void 0===t&&(t={});var n=void 0!==t.binary&&t.binary,a=[],i=0;if(e.traverse(function(e){if(e.isMesh){var t=e.geometry;t.isBufferGeometry&&(t=(new THREE.Geometry).fromBufferGeometry(t)),t.isGeometry&&(i+=t.faces.length,a.push({geometry:t,matrixWorld:e.matrixWorld}))}}),n){var l=80,c=new ArrayBuffer(2*i+3*i*4*4+80+4);(E=new DataView(c)).setUint32(l,i,!0),l+=4;for(var f=0,s=a.length;f<s;f++){var p=(g=a[f]).geometry.vertices,u=g.geometry.faces,y=g.matrixWorld;o.getNormalMatrix(y);for(var d=0,m=u.length;d<m;d++){var x=u[d];r.copy(x.normal).applyMatrix3(o).normalize(),E.setFloat32(l,r.x,!0),l+=4,E.setFloat32(l,r.y,!0),l+=4,E.setFloat32(l,r.z,!0),l+=4;for(var v=[x.a,x.b,x.c],b=0;b<3;b++)r.copy(p[v[b]]).applyMatrix4(y),E.setFloat32(l,r.x,!0),l+=4,E.setFloat32(l,r.y,!0),l+=4,E.setFloat32(l,r.z,!0),l+=4;E.setUint16(l,0,!0),l+=2}}return E}var E="";for(E+="solid exported\n",f=0,s=a.length;f<s;f++){var g;for(p=(g=a[f]).geometry.vertices,u=g.geometry.faces,y=g.matrixWorld,o.getNormalMatrix(y),d=0,m=u.length;d<m;d++){for(x=u[d],r.copy(x.normal).applyMatrix3(o).normalize(),E+="\tfacet normal "+r.x+" "+r.y+" "+r.z+"\n",E+="\t\touter loop\n",v=[x.a,x.b,x.c],b=0;b<3;b++)r.copy(p[v[b]]).applyMatrix4(y),E+="\t\t\tvertex "+r.x+" "+r.y+" "+r.z+"\n";E+="\t\tendloop\n",E+="\tendfacet\n"}}return E+"endsolid exported\n"})}}]);